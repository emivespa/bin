#!/usr/bin/env bash
#
# - organize your git clones
#
# git clonex $mode $url
#
# git clonex a https://r.e/p/o == git clone https://a.b/c/d ~/src/r.e/p/o
# git clonex r https://r.e/p/o == git clone https://a.b/c/d ./r.e/p/o

set -eu -o pipefail

mode="$1"; shift
url="$1"; shift

case "$url" in
	(*'://'*)
		dir="${url#*://}"
		;;
	('git@'*)
		dir="${url/:/\/}" # FIXME: this is the only lines that requires bash instead of sh.
		;;
	(*)
		dir="${url/:/\/}" # FIXME: this is the only lines that requires bash instead of sh.
		;;
esac

case "$mode" in
	(a) dir="${HOME}/src/${dir}"  ;; # "absolute"
	(r) dir="./${dir}"            ;; # "relative"
	(*) exit 1                    ;;
esac

git clone ${1+"$@"} "$url" "$dir"
echo "${dir}" | cbx
