#!/bin/sh -e
#
# - GitHub gist helper
#
# TODO: take extension from $1

dir="$(mktemp -d "${TMPDIR:-"/tmp"}"/gist.XXX)"
file="${dir}/gistfile1${GIST_SUFFIX+."${GIST_SUFFIX}"}"
on_exit() {
	rm "$dir" -r
}
trap on_exit EXIT

cat ${@:-/dev/null} |
	vipe --suffix "${GIST_SUFFIX}" |
	tee >"${file}"

gh gist create "${file}" |
	tee /dev/tty |
	xargs xdg-open
